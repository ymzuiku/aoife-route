!function(e,t){"object"==typeof exports&&"undefined"!=typeof module?module.exports=t():"function"==typeof define&&define.amd?define(t):(e=e||self).Route=t()}(this,function(){"use strict";function a(e){try{return decodeURIComponent(e.replace(/\+/g," "))}catch(e){return null}}var c={parse:function(e,t){if(!e)return null;for(var n,o=/([^=?&]+)=?([^&]*)/g,r={};n=o.exec(e);){var i=a(n[1]),u=a(n[2]);null===i||null===u||i in r||(t||(u=isNaN(Number(u))?u:Number(u)),r[i]=u)}return r},stringify:function(e,t){void 0===t&&(t="");var n,o,r=[];for(o in"string"!=typeof t&&(t="?"),e)if(Object.prototype.hasOwnProperty.call(e,o)){if((n=e[o])||null!=n&&!isNaN(n)||(n=""),o=encodeURIComponent(o),n=encodeURIComponent(n),null===o||null===n)continue;r.push(o+"="+n)}return r.length?t+r.join("&"):""},decode:a},n=[];function f(e){var t=document.createElement("span");return t.style.display="none",t.setAttribute("aoife-route",e),t}["popstate","pushState","replaceState"].forEach(function(e){window.addEventListener(e,function(){t.state=c.parse(location.search),n.forEach(function(e){return e()})})});var l=0,t=function(e){var o=e.root,r=e.url,i=e.render,u=e.preload;if("function"!=typeof i)throw"AoifeRoute.render need a Function";function t(){if(u&&i(),"function"==typeof r){if(!r())return f(a)}else{var e=!1;if(o&&"/"===window.location.pathname&&(e=!0),!e&&c.decode(window.location.pathname)!==r)return f(a)}var t=i();if(t.then){var n=f(a);return Promise.resolve(t).then(function(e){if(e.default){var t=document.querySelector('[aoife-route="'+a+'"]');if(!t)return;var n=e.default();n.setAttribute("aoife-route",a),t.replaceWith(n)}}),n}return t.setAttribute("aoife-route",a),t}var a=""+(l+=1);return n.push(function(){var e=document.querySelector('[aoife-route="'+a+'"]');e&&e.replaceWith(t())}),t()};return t.state={},t.queryString=c,t.push=function(e,t,n){t&&(e+="?"+c.stringify(t)),history.pushState(t,"",e),window.dispatchEvent(new Event("pushState")),n||document.documentElement.scrollTo({top:0})},t.replace=function(e,t,n){t&&(e+="?"+c.stringify(t)),history.replaceState(t,"",e),window.dispatchEvent(new Event("replaceState")),n||document.documentElement.scrollTo({top:0})},t.back=function(){history.back()},t});
//# sourceMappingURL=index.js.map
