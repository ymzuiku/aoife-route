!function(e,t){"object"==typeof exports&&"undefined"!=typeof module?module.exports=t(require("querystring-number")):"function"==typeof define&&define.amd?define(["querystring-number"],t):(e=e||self).Route=t(e.queryString)}(this,function(o){"use strict";o=o&&Object.prototype.hasOwnProperty.call(o,"default")?o.default:o;var e=navigator.userAgent.toLocaleLowerCase(),t=/(?:iphone)/.test(e),e=/micromessenger/.test(e),c={},s=[];function p(e){var t=document.createElement("span");return t.style.display="none",t.setAttribute("aoife-route",e),t.setAttribute("aoife-route-empty",e),t}function l(e){return"function"==typeof e?e():o.decode(window.location.pathname)===e}["popstate","pushState","replaceState","backState"].forEach(function(e){window.addEventListener(e,function(){a.state=o.parse(location.search),"popstate"!==e&&"backState"!==e||delete c[r],s.forEach(function(e){return e()}),"popstate"===e&&i.pop()})});var f=0,r="",i=[],d={},a=function(e){var n=e.url,r=e.render,i=e.preload,a=e.keep;if("function"!=typeof r)throw"AoifeRoute.render need a Function";i||"string"!=typeof n||(d[n]=r);function o(){i&&setTimeout(function(){r()},"number"==typeof i?i:50);var e=c[n];if("string"==typeof n&&e){var t=document.querySelector('[aoife-route="'+e+'"]');return t.__display||(t.__display=window.getComputedStyle?window.getComputedStyle(t).display:"block"),l(n)?t.style.display=t.__display:t.style.display="none",t}if(!l(n))return p(u);var o=a&&"string"==typeof n;if((e=r()).then){t=p(u);return Promise.resolve(e).then(function(e){var t;!e.default||(t=document.querySelector('[aoife-route="'+u+'"]'))&&((e=e.default()).setAttribute("aoife-route",u),o&&(c[n]=u),t.replaceWith(e))}),t}return e.setAttribute("aoife-route",u),o&&(c[n]=u),e}var u=""+(f+=1);return s.push(function(){var e,t=document.querySelector('[aoife-route="'+u+'"]');t&&((e=o()).getAttribute("aoife-route-empty")&&t.getAttribute("aoife-route-empty")||e!==t&&t.replaceWith(e))}),o()};a.onlyReplace=e&&t,a.preload=function(e){var t=d[e];"function"==typeof t&&(t(),d[e]=!0)},a.state={},a.queryString=o,a.push=function(e,t){a.onlyReplace?a.replace(e,t):(i.push({state:t,url:e}),t&&(e+="?"+o.stringify(t)),window.scrollTo&&window.scrollTo({top:0}),setTimeout(function(){history.pushState(t,"",e),window.dispatchEvent(new Event("pushState"))}))},a.replace=function(e,t){i.push({state:t,url:e}),t&&(e+="?"+o.stringify(t)),window.scrollTo&&window.scrollTo({top:0}),setTimeout(function(){history.replaceState(t,"",e),window.dispatchEvent(new Event("replaceState"))})};var u=function(e,t){var o,n;(e=void 0===e?1:e)<=0?t&&setTimeout(function(){t()}):(--e,r=location.pathname,0===i.length?(history.replaceState({},"","/"),window.dispatchEvent(new Event("backState"))):a.onlyReplace?(i.pop(),0===i.length?history.replaceState({},"","/"):(o=(n=i[i.length-1]).state,n=n.url,history.replaceState(o,"",n)),window.dispatchEvent(new Event("backState"))):history.back(),setTimeout(function(){u(e,t)}))};return a.back=function(t){return void 0===t&&(t=1),new Promise(function(e){u(t,e)})},a.rootURL="/",a});
//# sourceMappingURL=index.js.map
