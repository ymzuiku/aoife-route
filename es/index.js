var N=Object.create,m=Object.defineProperty,_=Object.getPrototypeOf,P=Object.prototype.hasOwnProperty,U=Object.getOwnPropertyNames,j=Object.getOwnPropertyDescriptor;var x=e=>m(e,"__esModule",{value:!0});var I=(e,t)=>()=>(t||(t={exports:{}},e(t.exports,t)),t.exports);var M=(e,t,a)=>{if(t&&typeof t=="object"||typeof t=="function")for(let o of U(t))!P.call(e,o)&&o!=="default"&&m(e,o,{get:()=>t[o],enumerable:!(a=j(t,o))||a.enumerable});return e},O=e=>M(x(m(e!=null?N(_(e)):{},"default",e&&e.__esModule&&"default"in e?{get:()=>e.default,enumerable:!0}:{value:e,enumerable:!0})),e);var T=I((w,R)=>{(function(e,t){typeof w=="object"&&typeof R!="undefined"?t(w):typeof define=="function"&&define.amd?define(["exports"],t):t((e=e||self).queryString={})})(w,function(e){"use strict";function t(n){try{return decodeURIComponent(n.replace(/\+/g," "))}catch(r){return null}}function a(n){try{return encodeURIComponent(n)}catch(r){return null}}function o(n,r){if(!n)return null;for(var i,s=/([^=?&]+)=?([^&]*)/g,c={};i=s.exec(n);){var l=t(i[1]),d=t(i[2]);if(!(l===null||d===null||l in c))if(r||typeof d!="string")c[l]=d;else{var E=Number(d),v=isNaN(E)?d:E;c[l]=d==v.toString()?v:d}}return c}function f(n,r){r===void 0&&(r="");var i,s,c=[];for(s in typeof r!="string"&&(r="?"),n)if(Object.prototype.hasOwnProperty.call(n,s)){if((i=n[s])||i!=null&&!isNaN(i)||(i=""),s=encodeURIComponent(s),i=encodeURIComponent(i),s===null||i===null)continue;c.push(s+"="+i)}return c.length?r+c.join("&"):""}var g={parse:o,stringify:f,decode:t,encode:a};e.decode=t,e.default=g,e.encode=a,e.parse=o,e.stringify=f,Object.defineProperty(e,"__esModule",{value:!0})})});var h=O(T()),k=/MicroMessenger/.test(navigator.userAgent),y={},A=[];["popstate","pushState","replaceState","backState"].forEach(e=>{window.addEventListener(e,()=>{u.state=h.default.parse(location.search),A.forEach(t=>t()),(e==="popstate"||e==="backState")&&delete y[C],e==="popstate"&&p.pop()})});function S(e){let t=document.createElement("span");return t.style.display="none",t.setAttribute("aoife-route",e),t}var q=0,b=!1,C="",p=[],u=({url:e,render:t,preload:a,cache:o})=>{if(typeof t!="function")throw"AoifeRoute.render need a Function";q+=1;let f=""+q,g=()=>{if(a&&t(),typeof e=="function"){if(!e())return S(f)}else if(h.default.decode(window.location.pathname)!==e)return S(f);if(typeof e=="string"&&y[e])return y[e];let n=o&&!b&&typeof e=="string";b=!1;let r=t();if(r.then){let i=S(f);return Promise.resolve(r).then(s=>{if(s.default){let c=document.querySelector(`[aoife-route="${f}"]`);if(!c)return;let l=s.default();l.setAttribute("aoife-route",f),n&&(y[e]=l),c.replaceWith(l)}}),i}return r.setAttribute("aoife-route",f),n&&(y[e]=r),r};return A.push(()=>{let n=document.querySelector(`[aoife-route="${f}"]`);!n||n.replaceWith(g())}),g()};u.state={};u.queryString=h.default;u.push=(e,t,{ignoreScrollTop:a,ignoreCache:o}={})=>{if(k){u.replace(e,t,{ignoreCache:o,ignoreScrollTop:a});return}p.push({state:t,url:e}),t&&(e+="?"+h.default.stringify(t)),a||window.scrollTo&&window.scrollTo({top:0}),setTimeout(()=>{o&&(b=!0),history.pushState(t,"",e),window.dispatchEvent(new Event("pushState"))})};u.replace=(e,t,{ignoreScrollTop:a,ignoreCache:o}={})=>{p.push({state:t,url:e}),t&&(e+="?"+h.default.stringify(t)),a||window.scrollTo&&window.scrollTo({top:0}),setTimeout(()=>{o&&(b=!0),history.replaceState(t,"",e),window.dispatchEvent(new Event("replaceState"))})};u.back=()=>{if(C=location.pathname,p.length===0){history.replaceState({},"","/"),window.dispatchEvent(new Event("backState"));return}if(k){if(p.pop(),p.length===0)history.replaceState({},"","/");else{let{state:e,url:t}=p[p.length-1];history.replaceState(e,"",t)}window.dispatchEvent(new Event("backState"));return}history.back()};var F=u;export{F as default};
