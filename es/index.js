function f(t){try{return decodeURIComponent(t.replace(/\+/g," "))}catch(e){return null}}function w(t,e){if(!t)return null;let r=/([^=?&]+)=?([^&]*)/g,o={},n;for(;n=r.exec(t);){let u=f(n[1]),i=f(n[2]);u===null||i===null||u in o||(e||(i=isNaN(Number(i))?i:Number(i)),o[u]=i)}return o}function b(t,e=""){let r=[],o,n;typeof e!="string"&&(e="?");for(n in t)if(Object.prototype.hasOwnProperty.call(t,n)){if(o=t[n],!o&&(o==null||isNaN(o))&&(o=""),n=encodeURIComponent(n),o=encodeURIComponent(o),n===null||o===null)continue;r.push(`${n}=${o}`)}return r.length?e+r.join("&"):""}var E={parse:w,stringify:b,decode:f},s=E;var y=[];["popstate","pushState","replaceState"].forEach(t=>{window.addEventListener(t,()=>{a.state=s.parse(location.search),y.forEach(e=>e())})});function h(t){let e=document.createElement("span");return e.style.display="none",e.setAttribute("aoife-route",t),e}var m=0,a=({root:t,url:e,render:r,preload:o})=>{if(typeof r!="function")throw"AoifeRoute.render need a Function";m+=1;let n=""+m,u=()=>{o&&r();let i=!1;if(t&&window.location.pathname==="/"&&(i=!0),!i&&s.decode(window.location.pathname)!==e)return h(n);let l=r();if(l.then){let g=h(n);return Promise.resolve(l).then(p=>{if(p.default){let d=document.querySelector(`[aoife-route="${n}"]`);if(!d)return;let c=p.default();c.setAttribute("aoife-route",n),c.setAttribute("aoife-route-url",e),d.replaceWith(c)}}),g}return l.setAttribute("aoife-route",n),l.setAttribute("aoife-route-url",e),l};return y.push(()=>{let i=document.querySelector(`[aoife-route="${n}"]`);!i||i.replaceWith(u())}),u()};a.state={};a.queryString=s;a.push=(t,e,r)=>{e&&(t+="?"+s.stringify(e)),history.pushState(e,"",t),window.dispatchEvent(new Event("pushState")),r||document.documentElement.scrollTo({top:0})};a.replace=(t,e,r)=>{e&&(t+="?"+s.stringify(e)),history.replaceState(e,"",t),window.dispatchEvent(new Event("replaceState")),r||document.documentElement.scrollTo({top:0})};a.back=()=>{history.back()};var S=a;export{S as default};
