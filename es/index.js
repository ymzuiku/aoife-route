function s(t){try{return decodeURIComponent(t.replace(/\+/g," "))}catch(e){return null}}function w(t,e){if(!t)return null;let i=/([^=?&]+)=?([^&]*)/g,o={},n;for(;n=i.exec(t);){let l=s(n[1]),r=s(n[2]);l===null||r===null||l in o||(e||(r=isNaN(Number(r))?r:Number(r)),o[l]=r)}return o}function g(t,e=""){let i=[],o,n;typeof e!="string"&&(e="?");for(n in t)if(Object.prototype.hasOwnProperty.call(t,n)){if(o=t[n],!o&&(o==null||isNaN(o))&&(o=""),n=encodeURIComponent(n),o=encodeURIComponent(o),n===null||o===null)continue;i.push(`${n}=${o}`)}return i.length?e+i.join("&"):""}var b={parse:w,stringify:g,decode:s},u=b;var m=[];["popstate","pushState","replaceState"].forEach(t=>{window.addEventListener(t,()=>{c.state=u.parse(location.search),m.forEach(e=>e())})});function f(t){let e=document.createElement("span");return e.style.display="none",e.setAttribute("aoife-route",t),e}var h=0,c=({root:t,url:e,render:i,preload:o})=>{if(typeof i!="function")throw"AoifeRoute.render need a Function";h+=1;let n=""+h,l=()=>{if(o&&i(),typeof e=="function"){if(!e())return f(n)}else{let a=!1;if(t&&window.location.pathname==="/"&&(a=!0),!a&&u.decode(window.location.pathname)!==e)return f(n)}let r=i();if(r.then){let a=f(n);return Promise.resolve(r).then(p=>{if(p.default){let d=document.querySelector(`[aoife-route="${n}"]`);if(!d)return;let y=p.default();y.setAttribute("aoife-route",n),d.replaceWith(y)}}),a}return r.setAttribute("aoife-route",n),r};return m.push(()=>{let r=document.querySelector(`[aoife-route="${n}"]`);!r||r.replaceWith(l())}),l()};c.state={};c.queryString=u;c.push=(t,e,i)=>{e&&(t+="?"+u.stringify(e)),history.pushState(e,"",t),window.dispatchEvent(new Event("pushState")),i||document.documentElement.scrollTo({top:0})};c.replace=(t,e,i)=>{e&&(t+="?"+u.stringify(e)),history.replaceState(e,"",t),window.dispatchEvent(new Event("replaceState")),i||(window.scrollTo&&window.scrollTo({top:0}),document.body&&document.body.scrollTo&&document.body.scrollTo({top:0}),document.documentElement&&document.documentElement.scrollTo&&document.documentElement.scrollTo({top:0}))};c.back=()=>{history.back()};var E=c;export{E as default};
