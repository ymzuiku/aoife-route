var I=Object.create,w=Object.defineProperty,L=Object.getPrototypeOf,N=Object.prototype.hasOwnProperty,P=Object.getOwnPropertyNames,x=Object.getOwnPropertyDescriptor;var j=e=>w(e,"__esModule",{value:!0});var F=(e,t)=>()=>(t||(t={exports:{}},e(t.exports,t)),t.exports);var O=(e,t,f)=>{if(t&&typeof t=="object"||typeof t=="function")for(let u of P(t))!N.call(e,u)&&u!=="default"&&w(e,u,{get:()=>t[u],enumerable:!(f=x(t,u))||f.enumerable});return e},M=e=>O(j(w(e!=null?I(L(e)):{},"default",e&&e.__esModule&&"default"in e?{get:()=>e.default,enumerable:!0}:{value:e,enumerable:!0})),e);var _=F((h,v)=>{(function(e,t){typeof h=="object"&&typeof v!="undefined"?t(h):typeof define=="function"&&define.amd?define(["exports"],t):t((e=e||self).queryString={})})(h,function(e){"use strict";function t(o){try{return decodeURIComponent(o.replace(/\+/g," "))}catch(r){return null}}function f(o){try{return encodeURIComponent(o)}catch(r){return null}}function u(o,r){if(!o)return null;for(var i,n=/([^=?&]+)=?([^&]*)/g,c={};i=n.exec(o);){var y=t(i[1]),p=t(i[2]);if(!(y===null||p===null||y in c))if(r||typeof p!="string")c[y]=p;else{var S=Number(p),E=isNaN(S)?p:S;c[y]=p==E.toString()?E:p}}return c}function a(o,r){r===void 0&&(r="");var i,n,c=[];for(n in typeof r!="string"&&(r="?"),o)if(Object.prototype.hasOwnProperty.call(o,n)){if((i=o[n])||i!=null&&!isNaN(i)||(i=""),n=encodeURIComponent(n),i=encodeURIComponent(i),n===null||i===null)continue;c.push(n+"="+i)}return c.length?r+c.join("&"):""}var g={parse:u,stringify:a,decode:t,encode:f};e.decode=t,e.default=g,e.encode=f,e.parse=u,e.stringify=a,Object.defineProperty(e,"__esModule",{value:!0})})});var d=M(_()),T=navigator.userAgent.toLocaleLowerCase(),W=/(?:iphone)/.test(T),$=/micromessenger/.test(T),m={},k=[];["popstate","pushState","replaceState","backState"].forEach(e=>{window.addEventListener(e,()=>{s.state=d.default.parse(location.search),(e==="popstate"||e==="backState")&&delete m[R],k.forEach(t=>t()),e==="popstate"&&l.pop()})});function A(e){let t=document.createElement("span");return t.style.display="none",t.setAttribute("aoife-route",e),t.setAttribute("aoife-route-empty",e),t}function q(e){return typeof e=="function"?e():d.default.decode(window.location.pathname)===e}var C=0,R="",l=[],b={},s=({url:e,render:t,preload:f,keep:u})=>{if(typeof t!="function")throw"AoifeRoute.render need a Function";!f&&typeof e=="string"&&(b[e]=t),C+=1;let a=""+C,g=()=>{if(f){let n=typeof f=="number"?f:50;setTimeout(()=>{t()},n)}let o=m[e];if(typeof e=="string"&&o){let n=document.querySelector(`[aoife-route="${o}"]`);return n.__display||(n.__display=window.getComputedStyle?window.getComputedStyle(n).display:"block"),q(e)?n.style.display=n.__display:n.style.display="none",n}if(!q(e))return A(a);let r=u&&typeof e=="string",i=t();if(i.then){let n=A(a);return Promise.resolve(i).then(c=>{if(c.default){let y=document.querySelector(`[aoife-route="${a}"]`);if(!y)return;let p=c.default();p.setAttribute("aoife-route",a),r&&(m[e]=a),y.replaceWith(p)}}),n}return i.setAttribute("aoife-route",a),r&&(m[e]=a),i};return k.push(()=>{let o=document.querySelector(`[aoife-route="${a}"]`);if(!o)return;let r=g();r.getAttribute("aoife-route-empty")&&o.getAttribute("aoife-route-empty")||r!==o&&o.replaceWith(r)}),g()};s.onlyReplace=$&&W;s.preload=e=>{let t=b[e];typeof t=="function"&&(t(),b[e]=!0)};s.state={};s.queryString=d.default;s.push=(e,t)=>{if(s.onlyReplace){s.replace(e,t);return}l.push({state:t,url:e}),t&&(e+="?"+d.default.stringify(t)),window.scrollTo&&window.scrollTo({top:0}),setTimeout(()=>{history.pushState(t,"",e),window.dispatchEvent(new Event("pushState"))})};s.replace=(e,t)=>{l.push({state:t,url:e}),t&&(e+="?"+d.default.stringify(t)),window.scrollTo&&window.scrollTo({top:0}),setTimeout(()=>{history.replaceState(t,"",e),window.dispatchEvent(new Event("replaceState"))})};var H=()=>{if(R=location.pathname,l.length===0){history.replaceState({},"","/"),window.dispatchEvent(new Event("backState"));return}if(s.onlyReplace){if(l.pop(),l.length===0)history.replaceState({},"","/");else{let{state:e,url:t}=l[l.length-1];history.replaceState(e,"",t)}window.dispatchEvent(new Event("backState"));return}history.back()},U=(e=1,t)=>{if(e<=0){t&&setTimeout(()=>{t()});return}e-=1,H(),setTimeout(()=>{U(e,t)})};s.back=(e=1)=>new Promise(t=>{U(e,t)});s.rootURL="/";var K=s;export{K as default};
