function s(t){try{return decodeURIComponent(t.replace(/\+/g," "))}catch(e){return null}}function g(t,e){if(!t)return null;let i=/([^=?&]+)=?([^&]*)/g,o={},n;for(;n=i.exec(t);){let u=s(n[1]),r=s(n[2]);u===null||r===null||u in o||(e||(r=isNaN(Number(r))?r:Number(r)),o[u]=r)}return o}function w(t,e=""){let i=[],o,n;typeof e!="string"&&(e="?");for(n in t)if(Object.prototype.hasOwnProperty.call(t,n)){if(o=t[n],!o&&(o==null||isNaN(o))&&(o=""),n=encodeURIComponent(n),o=encodeURIComponent(o),n===null||o===null)continue;i.push(`${n}=${o}`)}return i.length?e+i.join("&"):""}var E={parse:g,stringify:w,decode:s},c=E;var h=[];["popstate","pushState","replaceState"].forEach(t=>{window.addEventListener(t,()=>{a.state=c.parse(location.search),h.forEach(e=>e())})});function f(t){let e=document.createElement("span");return e.style.display="none",e.setAttribute("aoife-route",t),e}var m=0,a=({root:t,url:e,render:i,preload:o})=>{if(typeof i!="function")throw"AoifeRoute.render need a Function";m+=1;let n=""+m,u=()=>{if(o&&i(),typeof e=="function"){if(!e())return f(n)}else{let l=!1;if(t&&window.location.pathname==="/"&&(l=!0),!l&&c.decode(window.location.pathname)!==e)return f(n)}let r=i();if(r.then){let l=f(n);return Promise.resolve(r).then(p=>{if(p.default){let d=document.querySelector(`[aoife-route="${n}"]`);if(!d)return;let y=p.default();y.setAttribute("aoife-route",n),d.replaceWith(y)}}),l}return r.setAttribute("aoife-route",n),r};return h.push(()=>{let r=document.querySelector(`[aoife-route="${n}"]`);!r||r.replaceWith(u())}),u()};a.state={};a.queryString=c;a.push=(t,e,i)=>{e&&(t+="?"+c.stringify(e)),history.pushState(e,"",t),window.dispatchEvent(new Event("pushState")),i||document.documentElement.scrollTo({top:0})};a.replace=(t,e,i)=>{e&&(t+="?"+c.stringify(e)),history.replaceState(e,"",t),window.dispatchEvent(new Event("replaceState")),i||document.documentElement.scrollTo({top:0})};a.back=()=>{history.back()};var b=a;export{b as default};
